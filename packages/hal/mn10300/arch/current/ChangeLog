1999-04-28  Bart Veer  <bartv@cygnus.co.uk>

	* src/PKGconf.mak:
	Remove the -n argument to tail, it does not appear to be required
	on any supported host and causes problems with some
	implementations of tail.

1999-04-20  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/hal_cache.h: 
	(HAL_DCACHE_IS_ENABLED) (HAL_ICACHE_IS_ENABLED): Add these new macros
	(HAL_DCACHE_DISABLE) (HAL_ICACHE_DISABLE): Make variables register
	variables
	Ensure the cache has finished its operation before exitting.
	(HAL_DCACHE_INVALIDATE_ALL) (HAL_ICACHE_INVALIDATE_ALL): Make
	variables register variables.
	Re-enable cache if it was enabled on entry.
	(HAL_DCACHE_WRITE_MODE): Make variables register variables.
	Re-enable data cache if it was enabled on entry.
	Ensure the cache has finished its operation before exitting.
	(HAL_DCACHE_STORE): Make variables register variables.
	Re-enable data cache if it was enabled on entry.

	These fix PR19887

1999-04-15  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/mn10300.ld: Define __bss_end at the end of the BSS
	* src/vectors.S (_start): Use __bss_end rather than _end when clearing
	BSS
	These fix PR 19750

1999-04-15  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/hal_misc.c:
	* src/vectors.S:
	Separate parts of cyg_hal_invoke_constructors() out into new functions
	cyg_hal_enable_caches() and cyg_hal_debug_init() so that
	cyg_hal_invoke_constructors() can be called again safely if
	necessary
	Fix for PR19642

1999-04-14  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/PKGconf.mak (EXTRAS): Don't generate extras.o here any more
	But do define EXTRAS every time for the linker script.

1999-04-09  Jesper Skov  <jskov@cygnus.co.uk>

	* src/mn10300_stub.c: 
	Moved get_register and put_register to hal_stub.c.

1999-04-08  John Dallaway  <jld@cygnus.co.uk>

	* src/*.ld: Revised SECTION_* macro arguments to
	avoid padded output sections (PR 19787)

1999-03-31  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_arch.h (HAL_THREAD_INIT_CONTEXT): Align initial SP
	to a 4 byte boundary. Fixes PR 19695.

	* include/hal_cache.h: Added include of hal.h and a test that a
	valid set of macros have been added.

1999-03-26  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/hal_arch.h (CYGNUM_HAL_STACK_SIZE_MINIMUM): Be a little
	more generous since this stack should allow at least a kernel API
	call which could be at least 4 levels deep.

1999-03-23  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_arch.h:
	Modified stack size definitions to be more accurate.

1999-03-22  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/mn10300_stub.h: Update copyright

	* src/mn10300_stub.c: Update copyright

1999-03-22  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/hal_arch.h: 
	Use CYGNUM_HAL_STACK_SIZE_TYPICAL for the stack size instead of
	CYGNUM_HAL_MINIMUM_STACK_SIZE.

1999-03-19  Nick Garnett  <nickg@cygnus.co.uk>

	* src/hal_misc.c:
	* src/vectors.S:
	Fixed problem with taking breakpoints after watchdog interrupts
	and memory access exceptions. See the comments in
	__default_nmi_vsr in vector.S for details.

1999-03-17  John Dallaway  <jld@cygnus.co.uk>

	* src/PKGconf.mak: Remove dependence on echo '-e' switch.

1999-03-12  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/hal_arch.h: Add definition of 'CYGNUM_HAL_MINIMUM_STACK_SIZE'

1999-03-10  Jesper Skov  <jskov@cygnus.co.uk>

	* include/hal_intr.h (HAL_INTERRUPT_ATTACH): Added.

1999-03-08  Nick Garnett  <nickg@cygnus.co.uk>

	* src/mn10300.ld:
	Added alignment before definition of __DEVTAB__.

1999-03-05  Gary Thomas  <gthomas@cygnus.co.uk>

	* src/PKGconf.mak: 
	* src/mn10300.ld: Clean up I/O package changes.

1999-03-04  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/mn10300.ld: 
	Unconditionalize use of libextras.a and add to GROUP()

1999-02-25  Nick Garnett  <nickg@cygnus.co.uk>

	* src/hal_misc.c:
	Now tests for whether the kernel is present before trying to use
	patch_dbg_syscalls().

	* include/hal_intr.h (HAL_INTERRUPT_CONFIGURE): fixed some compile
	bugs in this macro.

	* src/vectors.S:
	Changed label used to access scheduler lock to one that is not
	mangled by C++. This is intended to make support for interrupt
	handling in non-kernel configurations easier.

1999-02-20  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/hal_arch.h: 
	Rename deliver_exception() -> cyg_hal_deliver_exception()
	QA improvements

	* include/hal_intr.h:
	Reorganise vector/interrupt/exception names according to purpose
	QA improvements

	* src/hal_misc.c:
	Rename deliver_exception() -> cyg_hal_deliver_exception()
	Rename CYG_VECTOR_* according to hal_intr.h changes above
	QA improvements

	* src/vectors.S:
	Rename exception_handler() -> cyg_hal_exception_handler()
	
1999-02-16  Jesper Skov  <jskov@cygnus.co.uk>

	* src/vectors.S: Changed set_debug_traps to initialize_stub.

	* src/mn10300_stub.c: 
	* include/mn10300_stub.h: 
	Cleaned up to only include arch specific stub code.

1999-02-15  Jesper Skov  <jskov@cygnus.co.uk>

	* include/basetype.h: Added CYG_LABEL_NAME macro.

1999-02-11  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_cache.h (HAL_DCACHE_STORE):
	Added "register" keywords to the variables used in this macro. If
	these are not in registers then when the cache is disabled, they
	can be stranded in the cache and the random values in main memory
	are used instead. This is only a problem when optimization is
	disabled; under optimization the compiler puts these variables
	into registers as a matter of course.
	Fixes PR 19165.
	(HAL_DCACHE_SYNC): Divide cache size by number of ways to
	calculate correct size to pass to HAL_DCACHE_STORE().

1999-02-05  John Dallaway  <jld@cygnus.co.uk>

	* src/mn10300.ld: Add LMA_EQ_VMA macro definition.

1999-02-01  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_cache.h: Fixed implementation of HAL_DCACHE_STORE() so
	that it now works, and changed implementation of HAL_DCACHE_SYNC()
	to use it.
	Fixes PR 18577 and is a better fix to 18849.
	
1999-01-27  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_intr.h:
	* src/vectors.S:
	Allow for NMI vectors in ISR table when using chained
	interrupts. This largely consists of moving the interrupt vector
	slots up by 3 entries.

1999-01-26  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* src/mn10300.ld:
	Add copyright notice.  (Though these files will later be generated
	by a tool and so not copyright, these default setups are.)

1999-01-25  Jesper Skov  <jskov@cygnus.co.uk>

	* src/mn10300_stub.c (__build_t_packet): Rewrote fix me text. Added PR
	number, but otherwise left the note.

1999-01-25  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_cache.h (HAL_DCACHE_SYNC): Add implementation of
	this macro to enable test programs to work.
	Fixes PR 18849.	

1999-01-21  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/hal_misc.c (cyg_hal_invoke_constructors): 
	Add code to deal with CYGSEM_HAL_STOP_CONSTRUCTORS_ON_FLAG
	Tidy up and update description header
	Shorten needlessly long lines
	Remove all traces of non-CYG_KERNEL_USE_INIT_PRIORITY code

1999-01-14  John Dallaway  <jld@cygnus.co.uk>

      * src/mn10300.ld: do not define _hal_vsr_table for minimal
      simulator builds

1999-01-13  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/basetype.h: CYG_DOUBLE_BYTEORDER now in <infra/cyg_type.h>

1999-01-13  John Dallaway  <jld@cygnus.co.uk>

      * src/mn10300.ld: define FOLLOWING () macro to simplify
      hand editing of linker script fragments

1999-01-12  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/basetype.h (CYG_DOUBLE_BYTEORDER): Define ordering
	for words within doubles.

1999-01-12  Nick Garnett  <nickg@cygnus.co.uk>

	* src/hal_misc.c: Altered call to patch_dbg_syscalls() to pass
	pointer to base of vector rather than a single vector entry.

1999-01-12  John Dallaway  <jld@cygnus.co.uk>

      * src/mn10300.ld: new linker script for MLT
      * src/PKGconf.mak: add mn10300.ld rules for MLT

1998-12-15  Jesper Skov  <jskov@cygnus.co.uk>

	* include/hal_arch.h: 
	* src/context.S (_hal_setjmp, _hal_longjmp):
        Added CYGARC definitions for jmpbuf entries.
	
1998-12-10  Jesper Skov  <jskov@cygnus.co.uk>

	* include/hal_cache.h (HAL_DCACHE_UNLOCK_ALL,
	HAL_ICACHE_UNLOCK_ALL): Added.

1998-11-25  Jesper Skov  <jskov@cygnus.co.uk>

	* include/hal_arch.h (HAL_REORDER_BARRIER): Changed to same form
	as on the other archs.

1998-11-18  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/hal_intr.h: Add support for interrupt latency
	measurement, controlled by CYGVAR_KERNEL_COUNTERS_CLOCK_LATENCY.

1998-11-09  Jesper Skov  <jskov@cygnus.co.uk>

	* src/vectors.S (__default_interrupt_vsr): Added GDB break
	support.
	Added call to GDB initialization during startup.

	* src/mn10300_stub.c: Changed instruction word type.

1998-11-06  Jesper Skov  <jskov@lassi.cygnus.co.uk>

	* src/PKGconf.mak: 
	Added stub to object list.

	* include/mn10300_stub.h: 
	* src/mn10300_stub.c:
	Added GDB stub.
	
	* src/hal_misc.c (exception_handler): Added GDB stub call.

1998-11-06  Jesper Skov  <jskov@cygnus.co.uk>

	* include/basetype.h (CYG_BYTEORDER): Fixed comment.

1998-11-16  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_cache.h:
	Added volatile keyword to appropriate places to prevent compiler
	optimizing out cache control register access.

1998-10-21  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_intr.h (HAL_CLOCK_READ):
	Fixed this macro to return correct value.

1998-10-16  Bart Veer  <bartv@cygnus.co.uk>

	* src/vectors.S (__interrupt_stack):
	Made the interrupt stack size configurable.

1998-10-16  Nick Garnett  <nickg@cygnus.co.uk>

	* src/hal_misc.c:
	Enabled caches by default.

1998-10-13  Nick Garnett  <nickg@cygnus.co.uk>

	* src/hal_misc.c:
	Altered ifdefs to allow builds without kernel.

Thu Sep 24 18:14:19 1998  Jesper Skov  <jskov@cygnus.co.uk>

	* include/hal_intr.h: Read the interrupt control registers back
	after writing to them to ensure that the value is not sitting in
	the store buffer.
	Also put _ around variable names in HAL_INTERRUPT_CONFIGURE for
	consistency.
	
1998-09-24  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_intr.h:
	Inverted mask for level in HAL_INTERRUPT_SET_LEVEL().

	* src/vectors.S:
	Added correct implementations of decode_interrupt macro for
	chained interrupt processing.
	Modified call to cyg_instrument() to pass table offset as well as
	vector number.
	Include <pkgconf/kernel.h> to allow call to cyg_instrument() to be
	enabled.

1998-09-14  Bart Veer  <bartv@cygnus.co.uk>

	* src/PKGconf.mak:
	Made vectors.o dependent on the various files that can contain
	makefile variables or rules. This is needed after changes to
	pkgconf.tcl for PRs 17195 and 17286.

Mon Sep 14 11:08:40 1998  Jesper Skov  <jskov@lassi.cygnus.co.uk>
        PR 17230
	
	* include/hal_intr.h: 
	* src/vectors.S: 
	Replaced CYGIMP_KERNEL_INTERRUPTS_CHAIN with new
	CYGIMP_HAL_COMMON_INTERRUPTS_CHAIN.

1998-09-12  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/hal_mn10300.h:
	Added missing descriptions (PR 17184)

	* src/hal_misc.c (exception_handler): 
	Sort out exception handling options (PR 16953)

Thu Sep 10 20:24:02 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/vectors.S (__default_interrupt_vsr): 
	Fix a bug.  Wrong offset when restoring the PSW tends to screw
	things up rather.

Thu Sep 10 15:12:21 1998  Jesper Skov  <jskov@lassi.cygnus.co.uk>
        PR 17153

	* src/vectors.S (__default_interrupt_vsr): Pass correct vector
	value to isr.

1998-09-09  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_arch.h:
	Removed distinction between interrupt and thread switch contexts
	in HAL_SavedRegisters. Modified appropriate macros to reflect this.

	* src/hal_misc.c (cyg_hal_invoke_constructors):
	Added call to patch_dbg_syscalls() for Cygmon hosted builds.

	* src/context.S (_hal_thread_switch_context):
	Adjust thread context so that it has the same structure as the
	state saved by interrupt and exception handlers. This makes
	supporting thread-aware debugging easier.

	* src/vectors.S:
	Moved nmi and trap vectors to correct slots in vsr table.
	Now place arg3 of interrupt_end() in correct stack slot.

1998-09-04  Bart Veer  <bartv@cygnus.co.uk>

	* src/vectors.S (__default_interrupt_vsr):
	Fixed type in configuration option name.

Thu Sep  3 15:15:57 1998  Tim Goodwin  <tgoodwin@cygnus.co.uk>

	* hal/mn10300/arch/current/src/PKGconf.mak
	* hal/mn10300/arch/current/src/makefile
	* hal/mn10300/arch/current/tests/PKGconf.mak

	s/panx/mn10300/g

1998-09-03  Nick Garnett  <nickg@cygnus.co.uk>

	* src/vectors.S:
	Fixed offset bug in __trap.
	Changed conditionals on runtime initialisation of VSR table to not
	do it in simulated targets.

1998-09-02  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/hal_mn10300.h:
	New header file for architecture-specific configuration options

	* tests/PKGconf.mak: 
	* src/PKGconf.mak: 
	Sort out package naming conventions.

1998-09-02  Nick Garnett  <nickg@cygnus.co.uk>

	* src/vectors.S:
	Moved NMI and TRAP VSRs down 1 word to match cygmon's use of the
	vector table. This may need to change back in the future.

1998-09-01  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_intr.h:
	Added CYG_VSR_COUNT, CYG_EXCEPTION_COUNT and CYG_ISR_COUNT.
	Modified HAL_TRANSLATE_VECTOR() for mn103002 to provide slots
	for the NMI vectors at start of hal_interrupt_* tables.

	* src/hal_misc.c (exception_handler):
	Added support for decoding NMI vectors and for calling watchdog
	ISR if present.

	* src/vectors.S:
	Modified behaviour of __default_nmi_vsr to support watchdog timer
	properly.
	Fixed indirection bug in __nmi and __trap.
	Modified offsets in hal_interrupt_* tables to provide slots for
	NMI vectors at start in mn103002.

1998-08-28  Bart Veer  <bartv@cygnus.co.uk>

	* src/vectors.S, src/context.S, src/hal_misc.c, include/hal_intr.h: 
	Updated for new kernel configuration option symbol names
	
Fri Aug 28 10:09:03 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/hal_misc.c: 
	rename __main() to cyg_hal_invoke_constructors() and remove
	initialised test

	* src/vectors.S (_start): 
	Change call of __main() to cyg_hal_invoke_constructors(), and call
	of main() to cyg_start()

1998-08-25  Nick Garnett  <nickg@cygnus.co.uk>

	* src/vectors.S:
	Now pass pointer to saved registers as third argument to
	interrupt_end().

	* include/hal_arch.h:
	Added macros to support GDB.

1998-08-21  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_cache.h: 
	Now includes cyg_type.h rather than ktypes.h.
	
	* src/hal_misc.c:
	Added calls to turn the caches on. But disabled them
	since they interact poorly with Cygmon (Cygmon does not
	flush the caches when setting/clearing breakpoints).

Wed Aug 19 18:19:32 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/hal_misc.c (__main): 
	Add void to function prototypes to silence warnings

1998-08-18  Nick Garnett  <nickg@cygnus.co.uk>

	* include/hal_arch.h: 
	* include/hal_intr.h:
	Now includes cyg_type.h rather than ktypes.h.

	* src/context.S: 
	* src/vectors.S: 
	* src/hal_misc.c:
	Now uses hal.h rather than kernel.h.

1998-08-17  Nick Garnett  <nickg@cygnus.co.uk>

	* src/vectors.S:
	Reorgnized ifdefs to better support kernel porting.

//===========================================================================
//####COPYRIGHTBEGIN####
//
// -------------------------------------------
// The contents of this file are subject to the Cygnus eCos Public License
// Version 1.0 (the "License"); you may not use this file except in
// compliance with the License.  You may obtain a copy of the License at
// http://sourceware.cygnus.com/ecos
// 
// Software distributed under the License is distributed on an "AS IS"
// basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the
// License for the specific language governing rights and limitations under
// the License.
// 
// The Original Code is eCos - Embedded Cygnus Operating System, released
// September 30, 1998.
// 
// The Initial Developer of the Original Code is Cygnus.  Portions created
// by Cygnus are Copyright (C) 1998,1999 Cygnus Solutions.  All Rights Reserved.
// -------------------------------------------
//
//####COPYRIGHTEND####
//===========================================================================
