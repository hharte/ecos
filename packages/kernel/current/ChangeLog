1999-04-28  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19850
 	* tests/stress_threads.c: Don't print text from alarm handler.

1999-04-27  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: 
	Use/test 'cyg_thread_delete()' function.
	Add ability to compute statistics with first datum removed which
	can show up cache effects.
	Show thread stack usage.

1999-04-26  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/kapi.h: Add missing function cyg_thread_delete();
	otherwise there is no way in the C API to re-use thread memory
	safely.  It just calls the destructor of the Cyg_Thread class.

	* src/common/kapi.cxx (cyg_thread_delete): Implement it.

1999-04-26  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/stress_threads.c: Commit a better version for Mark since I
	happen to have it here; having addressed the main concern of my
	approval process.  It runs better in sims so long as the
	constructor execution isn't messed with, nor timeslicing nor
	priority inheritance.

1999-04-23  Mark Galassi  <rosalia@cygnus.com>

	* tests/stress_threads.c (setup_death_alarm): shortened the
	simulator time by another factor of 10, hoping that it will not
	slow down nightly testing for simulator platforms too much.
	(perform_stressful_tasks): added writing of a bit pattern to the
	malloc()-ed spaces.  Also reduced stack requirements for threads.

1999-04-23  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/timer.cxx (Cyg_Timer::activate): we must also disable
	the alarm when resetting it so as to remove it from its queue, so
	that the enable afterwards places it on the right queue instead of
	assuming that, being enabled, it's already there.  (if not
	enabling, the behaviour is unchanged and correct) This was
	detected by uITRON tests[cx]4, with some random perms including
	enable CYGIMP_KERNEL_COUNTERS_MULTI_LIST,
	value CYGNUM_KERNEL_COUNTERS_MULTI_LIST_SIZE {8}.
	The PR is 19475.

1999-04-21  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/bin_sem1.cxx (bin_sem1_main): Doh!  Use priorities 4 and 5
	for the two threads so that they are unique (with a bitmap
	scheduler, the threads had prios 0 and 1 resp, which causes an
	assert in the attempt to set thread 0's prio to 1, "prios not
	unique").  PR 19904.

1999-04-20  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/stress_threads.c: applied my patch to fix stack sizes.
	And timing, in simulator; branch now matches the trunk.

1999-04-20  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/kcache2.c: 
	Reduce iterations for time_ilock(), time_dlock(), and test_dzero()
	if a simulated environment is detected
	Fix for PR 19853

1999-04-19  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/kill.cxx: Make delay ticks greater than 1 to prevent
	scheduling problems if the clock rolls over immediately
	Fix for PR 19516

1999-04-19  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/bin_sem1.cxx (bin_sem1_main): Add priorities to the
	threads so that they run sequentially like the tester expected.
	Otherwise simple timing, and shorter timeslicing, causes failure
	to be reported; likewise if the kernel happens not to run entry0
	first!
        (another checkin)
	(bin_sem1_main): Add conditional use of set_priority on
	CYGIMP_THREAD_PRIORITY as it should be.

1999-04-14  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/dbg_gdb.cxx: Fixed compiler warnings, cleaned up stub
	requirements (removed FIX ME).

1999-04-14  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/intr.hxx: 
	* src/intr/intr.cxx (call_pending_DSRs_inner): Rework calling of
	DSRs to allow calls from HAL code.  This will allow for proper
	use of a separate interrupt stack.

1999-04-14  Mark Galassi  <rosalia@cygnus.com>

	* tests/PKGconf.mak: added an ifndef for the AEB-1 board so that
	stress_threads is only built conditionally.

	* tests/stress_threads.c: added more config smarts suggested by
	Jesper for his configurations.

1999-04-13  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19822
	* src/debug/dbg_gdb.cxx: Current thread's registers live in
	registers, not _registers.

1999-04-13  Mark Galassi  <rosalia@cygnus.com>

	* tests/stress_threads.c: simple stressing of thread
	creation/deletion with some memory-intensive and alarm-based
	tasks.  This version is set so that it dies after DEATH_TIME_LIMIT
	seconds, currently set to 120.  #undef-ing DEATH_TIME_LIMIT makes
	the test run forever.  This is currently not working with the
	bitmap scheduler, probably for some simple reason, but I have not
	yet broken it down to see why.

1999-04-12  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/except1.cxx: 
	* tests/kexcept1.cxx: 
	Remove now unnecessary tx39-specific setting of
	CYGNUM_HAL_EXCEPTION_DATA_UNALIGNED_ACCESS VSR
	Part of cleanup for PR 19731

1999-04-09  Hugo Tyson  <hmt@cygnus.co.uk>

	Generally: thread->to_queue_head() moves a thread to the head of
	whatever queue it is on, if relevant.  This is so that a thread
	can change priority and then put itself at the front of its new
	run queue instead of the end; otherwise it yields too, which may
	be undesirable.  Particularly for internal use of priorities in
	the uITRON compatibility layer.

	* include/thread.hxx (class Cyg_Thread): to_queue_head(): new
	function. Define Cyg_Thread::rotate_queue() for all schedulers.
	Public inheritance of Cyg_ThreadQueue_Implementation.

	* include/thread.inl (class Cyg_Thread): to_queue_head(): new
	function. Define Cyg_Thread::rotate_queue() for all schedulers.

	* include/mlqueue.hxx (class Cyg_SchedThread_Implementation):
	to_queue_head(), ...ThreadQueue...::to_head(): new functions.

	* src/sched/mlqueue.cxx (class Cyg_SchedThread_Implementation):
	to_queue_head(), ...ThreadQueue...::to_head(): new functions.

	* include/bitmap.hxx (class Cyg_SchedThread_Implementation): 
	Add empty placeholders for rotate_queue() and to_queue_head() to
	maintain commonality of interface.

1999-04-08  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19667
	* kernel/current/src/common/thread.cxx:
	Removed obsolete Cyg_Thread constructor.

	* kernel/current/tests/testaux.hxx:
	* kernel/current/tests/thread0.cxx:
	* kernel/current/tests/thread1.cxx:
	Changed to use the new Cyg_Thread constructor.

1999-04-08  Jesper Skov  <jskov@cygnus.co.uk>

	* src/common/kapi.cxx: Minor indentation fixes.

1999-04-07  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19743
	* include/mfiximpl.inl (Cyg_Mempool_Fixed_Implementation): Moved
	argument assertions before the first use of the arguments.

1999-04-07  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kexcept1.c (except0_main): 
	* tests/except1.cxx (except0_main): 
	Use macro HAL_VSR_SET_TO_ECOS_HANDLER() if defined, to reset
	likely exception handler VSRs to eCos' default handlers - the
	target side equivalent to CYG_TEST_GDBCMD("handle SIGBUS nostop");
	The VSR may not be the eCos standard one in some implementations
	of cooperation with CygMon.

1999-03-31  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_COUNTERS_RTC_PERIOD):
	Fixed value of this option for TX39 66MHz to correct number.

1999-03-25  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: More adjustments to get clock latency correct.
	Some fine tuning of messages and layout to fit well within 80 columns.

1999-03-24  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h: Fixed an ifdef error.

1999-03-24  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx (NTEST_THREADS): Reduce # threads so test can
	build on smaller machines.  Also, only adjust timings by single
	"overhead" value instead of the more generous 2*overhead.

	* src/common/clock.cxx: Clock latency measurement defaults to 'off'.

1999-03-23  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache2.c: Reduced number of loops in time_ilock(). On the
	MN10300 and TX39 this caused the test to timeout in the testing
	farm.

1999-03-23  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: 
	* src/common/clock.cxx: Add 'measure_clock_latency' boolean which
	is used to turn clock latency measurements on/off.

1999-03-23  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/tm_basic.cxx (run_all_tests): Changed initial delay from
	100 ticks to 2. This is adequate for the purpose of letting the
	clock get going, while 100 ticks was too long on simulators.

1999-03-23  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kcache1.c:
	* tests/kcache2.c:
	* tests/kclock1.c:
	* tests/kexcept1.c:
	* tests/kflag1.c:
	* tests/kmbox1.c:
	* tests/kmemfix1.c:
	* tests/kmemvar1.c:
	* tests/kmutex1.c:
	* tests/ksched1.c:
	* tests/ksem1.c:
	* tests/kthread0.c:
	* tests/thread0.cxx:
	Use CYGNUM_HAL_STACK_SIZE_TYPICAL instead of "4096" and include
	hal_arch.h where necessary to get it.

1999-03-22  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/thread.inl (attach_stack): 
	Fix typo in assert; missing comma.

1999-03-22  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/debug/dbg-thread-syscall.h: Update copyright

1999-03-22  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/thread.inl:
	* src/common/thread.cxx:
	* tests/kthread1.c:
	* tests/testaux.hxx:
	* tests/thread1.cxx:
	* tests/thread_gdb.c:
	* tests/tm_basic.cxx:
	Use CYGNUM_HAL_STACK_SIZE_TYPICAL for the stack size instead of
	CYGNUM_HAL_MINIMUM_STACK_SIZE.
	Except for stack checking and the idle thread stack which uses 
	CYGNUM_HAL_STACK_SIZE_MINIMUM.

1999-03-19  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache1.c:
	* tests/kcache2.c:
	Made all CYG_INTERRUPT_STATE variables register variables. The
	value of this variable has to survive cache invalidation and does
	not in some testing permutations that are unoptimized.
	Fixes PR 19165.

	* include/kapi.h: Type of cyg_tick_count_t changed to cyg_uint64.
	Response to PR 19320.

1999-03-19  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Much better analysis of clock interrupt times.
	Print average deviation instead of variance.  Also print "confidence"
	numbers which are a measure of "how likely" a particular number would
	be relative to the mean and min of the sample set.

1999-03-17  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Improve messages and layout.
	Better message for 'hardware clock tick' value.

	* src/common/clock.cxx: Be more careful about clock latency delta
	values that are used/kept - some hardware can yield incorrect values.

	* tests/testaux.hxx: Use HAL recommended stack size for default.

1999-03-16  Nick Garnett  <nickg@cygnus.co.uk>

	* src/common/thread.cxx:
	Removed MIPS specific definition of idle_thread_stack[]. This is
	so it gets the benefit of the redefinition of
	CYGNUM_KERNEL_THREADS_IDLE_STACK_SIZE. This definition has also
	been made static, since the MIPS compiler would otherwise put it
	in the .data section.

	* include/intr.hxx (class Cyg_Interrupt):
	Changed implementation of Cyg_Interrupt::interrupts_enabled() to
	test the value of disable_counter, rather than the hardware.

1999-03-15  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache1.c:
	* tests/kcache2.c: 
	Added interrupt disables around cache operations. If these take
	too long, an inopportune interrupt can disrupt the cache contents,
	or result in the interrupt seeing an inconsistent world.

1999-03-15  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Improved and cleaned up messages overall.

1999-03-15  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19504
	* tests/tm_basic.cxx: Kill created threads after mutex, mbox and
	semaphore tests.

1999-03-12  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c: 
	Only try handling the SPARClite-SLEB vector correctly if
	CYG_HAL_USE_ROM_MONITOR_CYGMON ie. we are talking with CygMon.
	Otherwise the code is wrong, but also not used.  No matter.
	
1999-03-12  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kthread1.c: 
	* tests/thread1.cxx: 
	* tests/thread_gdb.c: 
	Deal with CYGNUM_HAL_MINIMUM_STACK_SIZE requirement.

1999-03-12  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/thread.inl (attach_stack): Add check/assert for minimum
	stack size (HAL defined)

1999-03-11  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c (patch_dbg_syscalls): 
	Use the correct vector table slot for SPARClite-SLEB; it's not 15
	on here, it's BSP_VEC_MT_DEBUG from the hal's hal_cygm.h

1999-03-11  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/testaux.hxx:
	Move definition of inline placement operator new outside of ifdef
	for NTHREADS so that it can be used by other code.

	* tests/intr0.cxx:
	* tests/thread1.cxx:
	Make use of placement operator new rather than dynamic one in
	intr0. Removed duplicate definition from thread1.

1999-03-11  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19472
	* tests/kill.cxx: Increased delays for the synthetic target.

1999-03-11  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19468
	* tests/intr0.cxx (intr0_main): 
	* tests/kintr0.c (kintr0_main): 
	Only attach interrupt handlers to vectors not in use.
	
1999-03-10  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19368
	* src/sched/sched.cxx (start): Change the dependency for
	referencing the RTC to make its inclusion independent of scheduler
	choice.

1999-03-10  Jesper Skov  <jskov@cygnus.co.uk>
        PR 17357
	* src/intr/intr.cxx (attach): Assert that interrupt vector attach
	will succeed.

1999-03-10  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Changed names used to control clock frequency on TX39 target.

1999-03-08  Gary Thomas  <gthomas@cygnus.co.uk>

	* src/sync/mutex.cxx: Allow 'Cyg_Condition_Variable::wait()'
	to be entered with the scheduler locked (and thsu exit in
	the same state).  This will allow for fully thread-safe use
	of 'Cyg_Condition_Variable::wait()'.

1999-02-26  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/except1.cxx (except0_main): 
	* tests/kexcept1.c (except0_main): 
	Move CYG_TEST_GDBCMD back to being before CYG_TEST_INIT

1999-02-26  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19283

	* src/common/kapi.cxx: Changed cyg_exception_call_handler
	definition to be consistent with declaration.

	* include/kapi.h: Change cyg_code_t to signed type.

	* tests/except1.cxx (except0_main): 
	* tests/kexcept1.c (except0_main): 
	Init diag before making first output.

1999-02-26  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19284
	* tests/mutex2.cxx (mutex2_main): Set priorities in a different
	order.

1999-02-25  Nick Garnett  <nickg@cygnus.co.uk>

	* include/sched.hxx (class Cyg_Scheduler_Base):
	Added CYGBLD_ATTRIB_ASM_ALIAS(cyg_scheduler_sched_lock) to
	declaration of sched_lock member. This makes it have the given
	name in the object and assembler files. This in turn eliminates
	the need to have a C++ mangled name in the HAL.

	* src/intr/intr.cxx:
	Cyg_Interrupt::detach() was not translating the vector to a table
	index correctly in the chained case. Fixed.

1999-02-24  Nick Garnett  <nickg@cygnus.co.uk>

	* include/intr.hxx: 
	* src/intr/intr.cxx:
	Added an interrupt disable counter to
	Cyg_Interrupt::disable_interrupts() and
	Cyg_Interrupt::enable_interrupts().

1999-02-23  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Added support for 66MHz part.

	* include/instrmnt.h:
	Added CYG_INSTRUMENT_EVENT_MUTEX_RELEASE and
	CYG_INSTRUMENT_EVENT_MUTEX_RELEASED. This should have been part of
	the 1999-02-22 checkin.

1999-02-23  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/clock0.cxx, tests/clock1.cxx, tests/except1.cxx,
	  tests/kcache1.c, tests/kcache2.c, tests/kclock0.c, tests/kclock1.c,
	  tests/kexcept1.c, tests/kflag0.c, tests/kflag1.c, tests/kill.cxx,
	  tests/kintr0.c, tests/kmbox1.c, tests/kmemfix1.c, tests/kmemvar1.c,
	  tests/kmutex0.c, tests/kmutex1.c, tests/ksched1.c, tests/ksem0.c,
	  tests/ksem1.c, tests/kthread0.c, tests/kthread1.c, tests/thread1.cxx:
	Use CYG_TEST_NA() rather than CYG_TEST_PASS_FINISH() for tests that
	are not applicable for this configuration

1999-02-22  Nick Garnett  <nickg@cygnus.co.uk>

	* include/kapi.h: 
	* include/mutex.hxx: 
	* src/sync/mutex.cxx: 
	* src/common/kapi.cxx: 
	* tests/mutex2.cxx:
	* tests/PKGconf.mak: 
	Added Kernel API support for thread release, which allows a thread
	to be broken out of any wait. Also added support for releasing all
	threads waiting to lock a mutex, both at C++ and Kernel API
	levels. Added a test program, mutex2, to test this fuctionality
	out.
	
1999-02-20  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/except.hxx: 
	* include/kapidata.h
	Rename CYG_EXCEPTION_COUNT -> CYGNUM_HAL_EXCEPTION_COUNT in line
	with HAL changes
	Rename deliver_exception() -> cyg_hal_deliver_exception()
	QA improvements

	* src/common/clock.cxx:
	Rename CYG_VECTOR_RTC -> CYGNUM_HAL_INTERRUPT_RTC in line with
	HAL changes

	* src/common/except.cxx:
	Rename CYG_EXCEPTION_* -> CYGNUM_HAL_EXCEPTION_* in line
	with HAL changes
	Allow for CYGNUM_HAL_EXCEPTION_MIN != 0
	Rename deliver_exception() -> cyg_hal_deliver_exception()
	Add more tracing, and fix some existing
	QA improvements

	* src/intr/intr.cxx:
	Rename CYG_ISR_* -> CYGNUM_HAL_ISR_* in line with HAL changes
	Add more tracing, and fix some existing
	QA improvements

	* src/sched/bitmap.cxx:
	* src/sched/mlqueue.cxx:
	* src/sync/mutex.cxx:
	Add more tracing and fix some existing
	QA improvements

	* tests/except1.cxx:
	* tests/kexcept1.c
	Rename CYG_EXCEPTION_* -> CYGNUM_HAL_EXCEPTION_* in line
	with HAL changes
	QA improvements
	Use new CYG_TEST_GDBCMD to tell GDB not to stop
	Remove special simulator case as it should now work

	* tests/intr0.cxx:
	* tests/kintr0.c:
	Rename CYG_ISR/VSR_* -> CYGNUM_HAL_ISR/VSR_* in line
	with HAL changes
	QA improvements		

1999-02-16  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/kexcept1.c (except0_main): Tell GDB to not stop on
	SIGBUS or SIGSEGV since we know we're going to cause an exception

1999-02-12  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/thread.cxx (idle_thread_stack): 
	Override CYGNUM_KERNEL_THREADS_IDLE_STACK_SIZE if
	CYGNUM_HAL_MINIMUM_STACK_SIZE demands it.

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_THREADS_IDLE_STACK_SIZE):
	Document that this option can be overridden by HALs demands.

1999-02-11  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/dbg-thread-syscall.h: 
	* src/debug/dbg-thread-demux.c: 
	Added handling of dbg_scheduler_func calls.

1999-02-11  Nick Garnett  <nickg@cygnus.co.uk>

	* include/kapi.h: 
	* src/common/kapi.cxx: 
	Added API support for per-thread data.

	* include/kapi.h: 
	* src/common/kapi.cxx:
	* tests/ksem1.c: 
	* tests/tm_basic.cxx: 
	Changed arguments to Kernel C API semaphore functions to take
	cyg_count32 rather than cyg_ucount32. This makes them consistent
	with the underlying implementation and allows for negative counts
	in the future. Changed some tests to match.
	Fixes PR 17877.

1999-02-08  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/kexcept1.c (entry0): 
	* tests/except1.cxx (entry0): 
	Don't call cause_exception on SIMs.

1999-02-05  Jesper Skov  <jskov@cygnus.co.uk>

	* src/common/clock.cxx (isr): Ignore a latency of 0 when finding
	min_clock_latency.

1999-02-04  Jesper Skov  <jskov@cygnus.co.uk>
        PR 19075
	* include/instrmnt.h: Slightly overdid the use of CYG_UNUSED_PARAM
	macros.

1999-02-04  Jesper Skov  <jskov@cygnus.co.uk>

	* src/intr/intr.cxx:
	Make instrumentation macros always use the parameters to avoid
	compiler warnings.

1999-02-03  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18075
	* tests/memfix1.cxx:
	* tests/kmemfix1.c:
	Make timing less sensitive.
	
1999-02-02  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/bin_sem2.cxx: Fixed compiler warning.

1999-02-02  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18971
	* tests/bin_sem2.cxx (bin_sem2_main): Reduce run time in SIM.

1999-02-01  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache2.c: Added calls to HAL_DCACHE_SYNC() before all
	relevant calls to HAL_DCACHE_DISABLE(). This should have been done
	on 1999-01-25 where is was only done to one instance.

1999-02-01  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Adjust stack sizes for platforms with
	limited memory.

1999-01-28  Nick Garnett  <nickg@cygnus.co.uk>

	* src/intr/intr.cxx: When using chained interrupts,
	interrupt_end() is passed NULL as the intr argument. If
	instrumentation is also enabled, the CYG_INSTRUMENT_INTR() calls
	will try to indirect through zero. Added ifdefs to avoid
	this. Also test intr for NULL before trying to post the DSR.
	Fixes PR 18771.

1999-01-28  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/tm_basic.cxx: Fixed strings.

1999-01-26  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kcache1.c (time0): Waste much less time if running in a
	simulator.  Do only 40 loops instead of 4000.
	In consequence the nasty meddling with MAX_STRIDE depending on
	HAL_xxx_SIM package definitions can go.

1999-01-26  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18902
	* src/debug/dbg-thread-demux.c: Oops. Undid my change of 1999-01-21.

1999-01-25  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/common/except.cxx: Make global exception initialisation object
	be constructed at INTERRUPT priority

1999-01-25  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18002
	* tests/thread_gdb.c: Ensure that there are enough priorities.

1999-01-25  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18875
	* tests/tm_basic.cxx: Ensure that there are enough priorities.

1999-01-25  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache2.c (test_dstore): Added call to HAL_DCACHE_SYNC()
	before disabling cache. On some architectures disabling the cache
	would cause the following call to do nothing.
	Fixes PR 18849.

1999-01-22  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/tm_basic.cxx: Don't run on Linux target.

1999-01-21  Hugo Tyson  <hmt@cygnus.co.uk>
	These changes are to get tests working with the SPARClite port; it
	doesn't do 8-byte register access unless it's properly aligned.
	
	* tests/philo.cxx (cyg_start): 
	Use tests/testaux.hxx to get new threads, to get the alignment
	required; see below.

	* tests/thread2.cxx (thread2_main):
	Use tests/testaux.hxx to get new threads, to get the alignment
	required; see below.

	* tests/tm_basic.cxx: 
	Larger stack for greedy processor.

	* tests/testaux.hxx: 
	thread_obj[][] and stack[][] are now 8-byte aligned like certain
	processors require; Cyg_Thread contains cyg_tick_count which is
	64-bit so any "standalone" C++ object would be so aligned.  These
	dynamically allocated ones should be too.

1999-01-21  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18747
	* tests/flag1.cxx: Increase delays/timeouts to prevent failure
	when configured with full trace logging.

1999-01-21  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c: Removed PR 17327 workarounds.

1999-01-19  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/sched/sched.cxx (start): 
	CYG_REFERENCE_SYMBOL -> CYG_REFERENCE_OBJECT in line with
	cyg_type.h change

1999-01-19  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18824
	* src/sync/mutex.cxx: 
	* include/pkgconf/kernel.h: Let
	CYGMFN_KERNEL_SYNCH_CONDVAR_TIMED_WAIT require
	CYGFUN_KERNEL_THREADS_TIMER.

1999-01-18  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c (patch_dbg_syscalls): Added test
	for CYGDBG_KERNEL_DEBUG_GDB_THREAD_SUPPORT in patch_dbg_syscalls().

1999-01-15  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/mvarimpl.inl (free): Memory list sort was incorrect.

	* tests/PKGconf.mak (TESTS): Don't build cache tests on
	some platforms.

1999-01-15  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18768
	
	* tests/kmbox1.c:
	* tests/mbox1.cxx:
	Increase delays used so the overhead of GDB packets doesn't make
	the tests fail.

1999-01-14  Jesper Skov  <jskov@cygnus.co.uk>

	* src/sched/sched.cxx (start): Use new CYG_REFERENCE_SYMBOL macro.

1999-01-14  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg_gdb.cxx: Extended return types to include success,
	fail and caller-do-it as required by msnyder.

	* src/debug/dbg-thread-demux.c: Moved prototype of dbg_scheduler()
	to dbg-threads-api.h.

1999-01-13  Jesper Skov  <jskov@cygnus.co.uk>

	* src/sched/sched.cxx (start): Better implementation of the
	real_time_clock reference.

1999-01-13  Jesper Skov  <jskov@cygnus.co.uk>

	* include/pkgconf/kernel.h: Disable CYGSEM_KERNEL_SCHED_TIMESLICE
	in CYG_HAL_ROM_MONITOR magic.

1999-01-07  Jesper Skov  <jskov@cygnus.co.uk>

	* include/pkgconf/kernel.h: Added RTC values for i386/Linux.


1999-01-12  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c:
	Changed API of patch_dbg_syscalls() to take a pointer to the start
	of the vector and insert several vectors.

	* src/debug/dbg_gdb.cxx:
	Added dbg_scheduler() function to allow debuggers to lock and
	unlock the scheduler. This helps when stepping multithreaded code.

	* include/sched.hxx:
	* include/sched.inl:
	Added Cyg_Scheduler::unlock_simple() to decrement the lock without
	rescheduling.

1999-01-05  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18574

	* src/sched/sched.cxx (start): Reference the real time clock to
	ensure it is included when linking.

1999-01-04  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/thread1.cxx:
	* tests/mbox1.cxx:
	* tests/kmbox1.c:
	* tests/kill.cxx:
	* tests/kflag1.c:
	* tests/kclock1.c:
	* tests/flag1.cxx:
	* src/common/thread.cxx:
	CYGFUN_KERNEL_THREADS_TIMER requires CYGVAR_KERNEL_COUNTERS_CLOCK
	so don't check for the latter explicitly.

1999-01-04  Jesper Skov  <jskov@cygnus.co.uk>
	PR 18573

	* tests/thread1.cxx:
	* tests/mbox1.cxx:
	* tests/kmbox1.c:
	* tests/kflag1.c:
	* tests/flag1.cxx:
        Don't run tests that rely on delay() when delay() is only defined
	as an empty function.

1998-12-24  Bart Veer  <bartv@cygnus.co.uk>

	* src/sync/mutex.cxx: 
	* src/sync/mbox.cxx: 
	* src/sync/flag.cxx: 
	* src/sched/sched.cxx: 
	* src/mem/memvar.cxx: 
	* src/mem/memfixed.cxx: 
	* src/common/thread.cxx: 
	* src/common/clock.cxx:
	* include/mempoolt.inl: 
	* include/mempolt2.inl: 
	* include/mboxt2.inl: 
	* include/mboxt.inl:
	check_this() member functions should now be const

1998-12-22  Nick Garnett  <nickg@cygnus.co.uk>

	* include/instrmnt.h: Fixed casts for arguments to
	cyg_instrument() to work in C. Fixes PR 18413.

1998-12-21  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/pkgconf/kernel.h: Change AEB-1 clock scale.

1998-12-17  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Calculate system clock resolution
	based on 'CYGNUM_KERNEL_COUNTERS_RTC_RESOLUTION'

1998-12-16  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_COUNTERS_RTC_PERIOD): 
	Add support for new ARM AEB-1.

1998-12-16  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* tests/intr0.cxx (intr0_main): 
	* tests/kintr0.c (kintr0_main): 
	Conditionally use a different interrupt vector number on tx39 when
	in the simulator (according to cyg_test_is_simulator) so that
	these tests execute correctly in simulators.
	
1998-12-16  Jesper Skov  <jskov@cygnus.co.uk>
        PR 18546

	* tests/kill.cxx (cyg_start): Do NOP test if required kernel
	functionality is disabled.

1998-12-15  Jesper Skov  <jskov@cygnus.co.uk>

	* include/pkgconf/kernel.h: Changed
	CYGDBG_KERNEL_DEBUG_GDB_INCLUDE_STUBS to
	CYGDBG_HAL_DEBUG_GDB_INCLUDE_STUBS.

1998-12-14  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/tm_basic.cxx: Made use of cyg_mbox_get() conditional on
	CYGMFN_KERNEL_SYNCH_MBOXT_PUT_CAN_WAIT.

1998-12-14  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/tm_basic.cxx: Added requirement for kernel RTC.

1998-12-11  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/kcache2.c: Added tests of three more macros.

1998-12-10  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/kcache2.c: Added tests of three more macros.

1998-12-10  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/PKGconf.mak: 
	* tests/kcache2.c: 
	Added new cache test.

1998-12-04  Nick Garnett  <nickg@cygnus.co.uk>

	* include/intr.hxx:
	* src/intr/intr.cxx (cyg_interrupt_post_dsr): Added this function
	to allow functions in the HAL, which are always only in C, to call
	Cyg_Interrupt::post_dsr(). Have also returned post_dsr() to
	private parts of Cyg_Interrupt.

1998-12-04  Jesper Skov  <jskov@cygnus.co.uk>

	* include/intr.hxx (class Cyg_Interrupt): Made post_dsr public so
	it can be called from HAL interrupt arbiters.

1998-12-04  Jesper Skov  <jskov@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_COUNTERS_RTC_PERIOD):
	Set to the correct value for a 33.333MHz clock.

1998-12-02  Jesper Skov  <jskov@cygnus.co.uk>

	* src/intr/intr.cxx (interrupt_end, chain_isr): Got rid of magic
	interrupt constants.

1998-11-30  Gary Thomas  <gthomas@cygnus.co.uk>

	* include/pkgconf/kernel.h: Fix spelling of CYGVAR_KERNEL_COUNTERS_CLOCK

1998-11-25  Jesper Skov  <jskov@cygnus.co.uk>

	* src/common/thread.cxx (check_this): Check that stack_ptr is
	within its limits.

Wed Nov 25 18:45:12 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/sched.inl (unlock) (lock): 
	* src/common/thread.cxx (thread_entry): 
	* src/sched/sched.cxx (unlock_inner): 

	Ensure all accesses to sched_lock cannot be reordered by the
	optimiser

1998-11-24  Jesper Skov  <jskov@cygnus.co.uk>

	* src/common/thread.cxx (thread_entry): Prevent scheduler lock
       	from being released too early.

1998-11-23  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	* src/common/clock.cxx:
	Added CYGIMP_KERNEL_COUNTERS_SORT_LIST option to determine whether
	the alarm lists in counters are sorted or not.

	* tests/tm_basic.cxx: Added a test for many alarms firing
	separately. 

1998-11-23  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/kcache1.c: Only run with stride 1 on SIMs.

1998-11-19  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Insure appropriate kernel configuration for
	building tool.  Needs at least kernel C API and multi-level scheduler.

1998-11-18  Gary Thomas  <gthomas@cygnus.co.uk>

	* tests/tm_basic.cxx: Add interrupt latency support.  Print 
	results to 10ns accuracy.

	* tests/PKGconf.mak: Add 'tm_basic' (the kernel timing test
	program) to list of built tests.

	* src/intr/intr.cxx: Change usage of HAL_INTERRUPT_MASK to have
	trailing ';' to match similar macros.

	* src/common/clock.cxx: 
	* include/pkgconf/kernel.h: Add CDL option 
	CYGVAR_KERNEL_COUNTERS_CLOCK_LATENCY used to define if interrupt
	latency measurements should be built into kernel.

1998-11-17  Jesper Skov  <jskov@cygnus.co.uk>

	* include/pkgconf/kernel.h: Renamed CYG_HAL_POWERPC_MP860 to
	CYG_HAL_POWERPC_MPC860.


1998-10-28  David Moore  <dsm@keema.cygnus.co.uk>

	* include/pkgconf/kernel.h
 	(CYGNUM_KERNEL_COUNTERS_RTC_RESOLUTION): Changed default value for
 	MIPS simulator to be 0.01 secs instead of 0.001 seconds.

1998-10-28  Jesper Skov  <jskov@cygnus.co.uk>

	* tests/kcache1.c (HAL_DCACHE_PURGE_ALL): Fixed compiler problem
	on PowerPC.

1998-10-27  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache1.c:
	Added calls to HAL_DCACHE_PURGE_ALL() before each test.  Added
	local version of HAL_DCACHE_PURGE_ALL() if this is not supplied by
	the HAL.

1998-10-27  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/thread.cxx (wake): 
	Remove the thread unconditionally from any queue it was on; for we
	have just become not-asleep, so it must be OK.  (Bug was: it
	didn't happen in transit WAIT-SUSPEND -> SUSPEND, so synch object
	still believed the task was waiting on it).  PR#17998

1998-10-26  Jesper Skov  <jskov@cygnus.co.uk>
        PR 17527, PR 17837

	* tests/kcache1.c: 
	* tests/kclock0.c: 
	* tests/kclock1.c: 
	* tests/clock1.cxx: 
	* tests/clock0.cxx: 
	Do N/A PASS when kernel real-time clock is configured out.

1998-10-26  Jesper Skov  <jskov@lassi.cygnus.co.uk>
        PR 17866

	* include/pkgconf/kernel.h
	(CYGNUM_KERNEL_THREADS_IDLE_STACK_SIZE): Doubled to prevent stack
	overruns on PowerPC.

1998-10-26  Jesper Skov  <jskov@cygnus.co.uk>
        PR 17987

	* src/debug/dbg_gdb.cxx (dbg_threadinfo): Removed "more: <none>"
	output.

1998-10-23  John Dallaway  <jld@cygnus.co.uk>

	* tests/tm_basic.cxx: Added basic timing test.

1998-10-23  Nick Garnett  <nickg@cygnus.co.uk>

	* include/instrmnt.h:
	Improved documentation of cyg_instrument_enable() and
	cyg_instrument_disable().

	* src/instrmnt/meminst.cxx:
	Added code to enable and disable whole groups of events.

1998-10-23  Jesper Skov  <jskov@lassi.cygnus.co.uk>

	* include/generic-stub.h: Deleted. It was moved to hal common some
	time ago.

Fri Oct 23 04:45:12 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/kcache1.c: 
	Remove forced warning of a warning which no longer applies

1998-10-22  Nick Garnett  <nickg@cygnus.co.uk>

	* src/common/clock.cxx:
	Stop searching the alarm list when the current alarm is in the
	future in Cyg_Counter::tick().  Changed sense of comparison in
	Cyg_Counter::add_alarm() to sort alarms in ascending order.

Thu Oct 22 18:21:50 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Fix commenting within CDL "comments"

Thu Oct 22 17:25:45 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Remove CYGVAR_KERNEL_INSTRUMENT_EXTERNAL_BUFFER configuration
	option. For PR 17838

1998-10-21  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_COUNTERS_RTC_PERIOD):
	Changed value for JMR3904 board to 15360 which is correct for a
	24.576MHz board rather than 25MHz as before.

	* src/common/thread.cxx:
	Exchanged stack_base and stack_size in idle thread constructor.

1998-10-20  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kflag1.c (kflag1_main): 
	Only mess with f2 if it exists, ie. CYGFUN_KERNEL_THREADS_TIMER.

1998-10-19  Mark Galassi  <rosalia@cygnus.com>

	* include/pkgconf/kernel.h: updated the doc URL

1998-10-19  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/kapi.h: 
	* include/kapidata.h (struct cyg_flag_t): 
	* src/common/kapi.cxx: 
	Add flags (Cyg_Flag, kernel.../flag.hxx) to the C API.

	* tests/PKGconf.mak (TESTS): 
	Add new tests for flags via the C API.

	* tests/kflag0.c: 
	* tests/kflag1.c: 
	New tests (well, versions of the plain C++ versions flag0.cxx and
	flag1.cxx) for flags via the kernel C API.
	
1998-10-19  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Fixed description of clock resolution.

1998-10-17  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Added a way of configuring the clock interrupt frequency.

Thu Oct 15 21:31:58 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Allow kernel to be disabled now

	* src/common/delete.cxx, src/common/memcpy.c, src/common/memset.c:
	Move these files to the infra package

	* src/PKGconf.mak:
	Don't build the above files any more

	Above changes are required for PR 17229

1998-10-15  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* include/mempoolt.inl (Cyg_Mempoolt): 
	* include/mempolt2.inl (Cyg_Mempolt2): 
	Flesh out the destructors to awaken any waiting threads
	with reason Cyg_Thread::DESTRUCT to support uITRON
	create and delete of memory pool objects.
	Note that only template mempolt2 is actually used.
	
Wed Oct 14 21:45:54 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/thread_gdb.c: 
	Remove unnecessary inclusion of <cyg/kernel/diag.h>

	* tests/kcache1.c: 
	Add a warning to expect the "function declaration isn't a
	prototype" warning from infra/diag.h

1998-10-14  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/thread.cxx (kill,reinitialize): 
	Do not refer to member timer unless CYGFUN_KERNEL_THREADS_TIMER is
	defined.
	
1998-10-14  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c:
	Now get dbg-threads-api.h from HAL.

	* src/debug/dbg_gdb.cxx:
	Tidied up info sent back by dbg_threadinfo().

	* src/common/thread.cxx:
	Changed constructor of idle thread to include initial priority and
	a thread name.

	* include/pkgconf/kernel.h:
	Moved GDB stub configuration code out to hal.h.

	* include/ktypes.h:
	Moved definition of CYG_LABEL_NAME() out to cyg_type.h.

	* src/debug/PKGconf.mak:
	* src/debug/dbg-threads-api.h:
	* src/debug/generic-stub.c:
	* src/debug/stubrom.c:
	* src/debug/thread-packets.c:
	* src/debug/thread-pkts.h:
	These files have all be relocated to hal/common.

1998-10-14  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/thread.hxx (class Cyg_Thread): 
	Add public members get_stack_base(), get_stack_size() and
	get_stack_limit();
	Add private members add_to_list() and remove_from_list() to
	centralize handling of the CYGVAR_KERNEL_THREADS_LIST as it is
	known.

	* include/thread.inl (class Cyg_Thread): 
	Add public members get_stack_base(), get_stack_size() and
	get_stack_limit();

	* src/common/thread.cxx: 
	Add private members add_to_list() and remove_from_list() to
	centralize handling of the CYGVAR_KERNEL_THREADS_LIST as it is
	known.
	Tidy up the two constructors to use them.
	Add CYG_REPORT_RETURN()/_RETVAL(...) logging throughout.
	Tidy up reinitialize() to use the 6-argument constructor,
	thus preserving the thread name.
	Fix some bugs in the CYGVAR_KERNEL_THREADS_LIST stuff where
	re-adding a thread caused loops in the list, and the like.
	Fix bug in set_priority() when the thread is asleep but NOT on any
	queue, such as a plain counted_sleep().

1998-10-14  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/thread-packets.c: 
	* src/debug/dbg_gdb.cxx: 
	Don't include hal_stub.h unless it's really, really, really
	needed.
		
1998-10-14  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/dbg_gdb.cxx: Don't include hal_stub.h unless it's really
	needed.

1998-10-13  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/generic-stub.c: Added thread support. Renaming a few
	functions/variables to match the most recent libstub
	generic-stub.c.
	Use thread_get_register & thread_put_register when handling GDB
	register packets.

	* src/debug/dbg_gdb.cxx (dbg_getthreadreg, dbg_getthreadreg):
	DTRT for current thread when CygMon is not configured.
	
	* src/debug/dbg_gdb.cxx (dbg_threadlist, dbg_getthreadreg,
	dbg_getthreadreg): return true/false rather than 0, 1, -1.
	
	* src/debug/dbg_gdb.cxx:
	* src/debug/dbg-threads-api.h: 
	Added dbg_currthread_id.

1998-10-08  Jesper Skov  <jskov@lassi.cygnus.co.uk>

	* src/debug/generic-stub.c: 
	* src/debug/generic-stub.h: 
	Added control of interrupts.
	Removed unused functions set_debug_trap and initialize_stub.
	
Tue Oct 13 17:36:29 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/test/tsttracc.c (cyg_start): 
	Replace CYG_REPORT_FUNCARGSVOID with the correct
	CYG_REPORT_FUNCARGVOID

1998-10-09  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/thread.cxx: 
	clear_timer() is a static which always affects the executing
	thread and none other.  Removed the "foo->" from various
	"foo->clear_timer()" calls to make this less confusing.
	Ditto set_timer().
	Changed a "clear_timer()" call to "timer.disable()" and added one
	so that they affect _this_ thread, the thread which is being
	kill()ed or reinitialize()d rather than the killer or the
	resuscitator.  Otherwise the alarm list can still get a loop in
	it when a thread's killed when waiting with a timeout and
	restarted soon enough.
	
1998-10-08  Hugo Tyson  <hmt@cygnus.co.uk>

	In general, these changes are to support create/delete of uITRON
	objects; this requires that an object can be destroyed whilst
	there are threads waiting on it, and that they shall be awoken
	with a specific return code.

	* include/thread.hxx:
	Cyg_Thread::DESTRUCT added to wake reasons, to deal with an object
	being destroyed whilst a thread is waiting on it; it's handled in
	a manner very similar to release() and BREAK wake_reason.
	
	* src/common/thread.cxx: 
	thread_entry(): threads now exit() if the entry_point returns.
	Cyg_Thread() constructors now initialize wake_reason to NONE.
	reinitialize() clears any pending timeout before calling
	constructors.
	counted_sleep( [timeout] ) now both deal with the wake reason in
	general, and with DESTRUCT in particular.
	exit() now clears any pending timeout.
	kill() now force_resumes the thread first.
	kill() now does not explicitly remove the thread from any queue
	it's on; wake() does that for you anyway.
	delay() clears the timer just in case and handles DESTRUCT
	properly.
	DESTRUCT added to various switches for completeness.

	The fixes to counted_sleep()[x2] and kill() are a bugfix for
	PR#17688.

	* include/flag.hxx:
	* src/sync/flag.cxx:
	Add an argument, defaulting to 0, to the constructor which sets
	the initial flag value.
	Add handing of DESTRUCT wake reason.
	Add a destructor which wakes all threads with DESTRUCT
	wake_reason.

	* include/mboxt2.inl:
	Add handing of DESTRUCT wake reason.
	Add a destructor which wakes all threads with DESTRUCT
	wake_reason.

	* src/sync/cnt_sem2.cxx:
	Add handing of DESTRUCT wake reason.
	Add a destructor which wakes all threads with DESTRUCT
	wake_reason.
	Correct typo in logic for queueing a waiting thread in
	Cyg_Counting_Semaphore2::wait( cyg_tick_count abs_timeout ).
	This is a bugfix for PR#17687.

	* include/mboxt.inl:
	* include/mempoolt.inl:
	* include/mempolt2.inl:
	* src/sync/bin_sem.cxx:
	* src/sync/cnt_sem.cxx:
	* src/sync/mutex.cxx:
	All these gain handling of the DESTRUCT wake_reason, that's all.
	
1998-10-08  Gary Thomas  <gthomas@penang.cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Add support for new architecture

1998-10-07  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache1.c (entry0):
	Replaced CYG_TEST_FINISH() with CYG_TEST_PASS_FINISH().

	* src/debug/dbg-thread-demux.c:
	Added dbg_thread_syscall_rmt_1() to save/set and restore the $gp
	register values when being called from Cygmon.

Sun Sep 27 20:12:15 1998  David Moore  <dsm@keema.cygnus.co.uk>

	* include/mlqueue.hxx: 
	* include/bitmap.hxx: 
	Disallow more than 32 priority levels
	
	* include/pkgconf/kernel.h:
	Changed range of allowed levels from 64 to 32

1998-09-27  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/memfix2.cxx:
	Changed message to say "Fixed memory pool 2 OK" rather than
	"Variable memory pool 2 OK".

1998-09-26  Bart Veer  <bartv@cygnus.co.uk>

	* include/intr.hxx (DSRs_pending):
	PR 17500: if DSR support is disabled completely then this inline
	function should not be defined at all.

1998-09-26  Nick Garnett  <nickg@cygnus.co.uk>

	* tests/kcache1.c:
	Added this test program for cache API. Includes some performance
	testing.

1998-09-25  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg_gdb.cxx:
	Removed some debugging code.

	* tests/thread_gdb.c:
	Added this test program to allow for GDB thread support testing.

1998-09-25  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	The GDB thread support requires the kernel to keep track of all
	threads on a linked list. This is a separate option. An additional
	requires statement enforces the dependency.
	
1998-09-25  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c:
	Added include of <pkgconf/kernel.h>, removed debug code.

1998-09-24  Bart Veer  <bartv@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c (dbg_thread_syscall_rmt):
	PR 17327. If kernel gdb thread support is disabled, do not compile
	in the relevant cases in the rmt switch statement. This is a
	partial solution to the general problem of how the HAL, kernel,
	cygmon, and gdb interact.

1998-09-24  Nick Garnett  <nickg@cygnus.co.uk>

	* src/common/clock.cxx (Cyg_RealTimeClock):
	Changed clock priority from zero to one, since it is now used to
	set the hardware interrupt priority.

	* src/intr/intr.cxx:
	Cyg_Interrupt::chain_isr() now only calls interrupt objects that
	have the matching vector number.
	Call HAL_INTERRUPT_SET_LEVEL() when attaching interrupts using the
	priority passed in the constructor.
	Added call to HAL_TRANSLATE_VECTOR() for attaching chained
	interrupts.

	* include/instrmnt.h (CYG_INSTRUMENT_EVENT_INTR_CHAIN_ISR):
	Added this event.

Thu Sep 24 11:07:12 1998  David Moore  <dsm@keema.cygnus.co.uk>

	* tests/except1.cxx: 
	* tests/kexcept1.cxx: 
	Made exception tests detect when CYGPKG_KERNEL_EXCEPTIONS
	is disabled.
	

1998-09-22  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Changed the kernel package from type bool to type dummy, since
	it is not yet possible to disable this package.

1998-09-20  Mark Galassi  <rosalia@cygnus.com>

	* include/pkgconf/kernel.h: updated CDL doc strings.
	fixed some typos in my doc strings.

1998-09-18  Nick Garnett  <nickg@cygnus.co.uk>

	* src/common/thread.cxx: 
	* include/thread.inl:
	Modified threads list from a LIFO stack to a ring so that we can
	add new ones to the end and present the threads to GDB in an order
	that more closely matches how it assigns thread ids.
	
Wed Sep 16 19:11:22 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/thread.inl (get_unique_id): 
	Move this declaration to before its first use, so that the user
	knows it is inline at the point of use.  Avoids a warning.

Wed Sep 16 08:49:48 1998  Jesper Skov  <jskov@cygnus.co.uk>
        PR 17269
 
 	* src/common/except.cxx (Cyg_Exception_Control): Replaced
	CYGNUM_EXCEPTION_MAX (bug!) with CYG_EXCEPTION_COUNT.
 
 	* include/kapidata.h (struct cyg_exception_conrol): Replaced
 	CYG_EXCEPTION_MAX (bug!) with CYG_EXCEPTION_COUNT.
 
 	* src/intr/intr.cxx:
 	* include/intr.hxx (class Cyg_Interrupt): Replaced CYG_ISR_MAX+1
 	with CYG_ISR_COUNT.
 
 	* include/except.hxx: Replaced CYGNUM_EXCEPTION_COUNT with
 	CYG_EXCEPTION_COUNT.
 
 	* tests/kintr0.c: 
 	* tests/intr0.cxx: Replaced CYG_ISR_MAX (bug!) with
 	CYG_ISR_COUNT.
 
Tue Sep 15 19:19:37 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/mboxt2.hxx:
	Add inclusion of thread.inl to silence warning

	* tests/kexcept1.c:
	Insert void as parameter list of __default_exception_vsr() to
	silence	warning

Tue Sep 15 19:16:52 1998  David Moore  <dsm@keema.cygnus.co.uk>

	* src/sched/sched.cxx: Cleaned up comments.

1998-09-15  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-thread-demux.c:
	Stubbed out led() function.

	* src/debug/dbg_gdb.cxx:
	Decide whether to byteswap thread id depending on reported byte
	order of target.
	Many small changes to debug code.

	* include/thread.inl (init_context):
	Changed CYG_DEBUG to CYGPKG_INFRA_DEBUG.

Tue Sep 15 09:35:14 1998  Jesper Skov  <jskov@cygnus.co.uk>
	PR 17236

	* src/common/clock.cxx (add_alarm): A retriggering alarm called
	with a trigger time in the past or now will be assigned a new
	trigger time. Don't find the counter list until the final trigger
	time is known.
	Also added a few #else error statements to catch a situation where
	no CYGIMP_KERNEL_COUNTERS_x_LIST implementation config is
	selected.
	
	* tests/clock0.cxx: Added extra ASSERT to ensure alarms enabled
	with a trigger time of now or in the past actually fire.
	* tests/kclock0.c: Same.
	
1998-09-15  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Cleaning up coonfiguration data (mostly improving the
	descriptions). 

Mon Sep 14 11:08:59 1998  Jesper Skov  <jskov@lassi.cygnus.co.uk>
        PR 17230

	* include/pkgconf/kernel.h: CYGIMP_KERNEL_INTERRUPTS_CHAIN
	requires CYGIMP_HAL_COMMON_INTERRUPTS_CHAIN.

1998-09-14  Mark Galassi  <rosalia@cygnus.com>

	* include/pkgconf/kernel.h: started adding CDL doc fields.

1998-09-12  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Sort out exception handling options (PR 16953)
	Added missing descriptions (PR 17184)

Fri Sep 11 19:18:28 1998  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* include/clock.hxx (class Cyg_Alarm): 
	* src/common/clock.cxx (Cyg_Alarm::add_alarm): 
	PR#17182
	Move the code to synchronize a repeating alarm which had been
 	firing in the dim and distant past with times in the future, which
 	had been inline in Cyg_Alarm::enable(), into a function of its
 	own, Cyg_Alarm::synchronize().  Call it from Cyg_Alarm::enable()
	and also from add_alarm() when the immediate time to fire is now
	or in the past; otherwise an initial time of, say, NOW-10 with an
	interval of 5 would just get lost.  Also corrected/commented the
	logic there to allow an alarm's handler to cancel itself.
	
Wed Sep  9 17:43:26 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/delete.cxx: 
	Control the provision of empty delete functions rather better, via
	an explicit option from the libc package.  Read the rather lengthy
	comment in delete.cxx for the explanation.
	Also note that the correct place for this functionality is in the
 	infrastructure, and the same should be done for the C++ new
 	functions also.

1998-09-09  Nick Garnett  <nickg@cygnus.co.uk>

	* src/common/thread.cxx:
	combined separate next_unique_id variables in both constructors.
	This would have caused duplicate thread ids to be generated.

	* include/thread.inl:
	Added code to initialize Cyg_HardwareThread::saved_context.

	* src/debug/dbg-thread-demux.c: 
	* src/debug/dbg_gdb.cxx:
	Many changes to get thread API working with Cygmon. Debug code
	currently left in place until complete testing is possible.

Tue Sep  8 17:17:32 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGNUM_KERNEL_COUNTERS_RTC_PERIOD):
	Set up a sensible default RTC for CYG_HAL_MN10300_SIM different
 	from that for the MN103002 or CYG_HAL_MN10300_STDEVAL1, so that
 	sim tests run in less than geological time.  This is the same as
 	the default value of before.

Fri Sep  4 18:25:02 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/sched/mlqueue.cxx (timeslice): 
	* src/sched/sched.cxx (unlock_inner): 
	Condition out the tracing macros here by default, for tracing
	these consumes the whole quantum.
	
1998-09-04  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Commented out the ROM monitor-specific option settings for now.
	
	* tests/kclock1.c: 
	* include/pkgconf/kernel.h: 
	* include/kapidata.h (struct cyg_counter): 
	Fixed typos in configuration option names.
	
1998-09-03  David Moore  <dsm@cygnus.co.uk>

	* include/pkgconf/kernel.h
 	(CYGNUM_KERNEL_INTERRUPTS_DSRS_TABLE_SIZE):
	Fixed typo in configuration option name.

	* src/intr/intr.cxx:
	Fixed typo in configuration option name.
	Fixed cast to incorrect type.
	
1998-09-03  Nick Garnett  <nickg@cygnus.co.uk>

	* src/PKGconf.mak (COMPILE): 
	Added debug/dbg-thread-demux.c to COMPILE list.
	
	* src/debug/dbg_gdb.cxx (dbg_threadinfo): 
	Added first cut at providing thread state string.
	
	* src/debug/dbg-thread-syscall.h: 
	* src/debug/dbg-thread-demux.c: 
	Added these two files to implement the interface between Cygmon
	and eCos.
	
1998-09-03  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h (CYGSEM_KERNEL_MEMORY_COALESCE): 
	* include/mvarimpl.inl (Cyg_Mempool_Variable_Implementation): 
	Fixed typo in configuration option name.
	
	* include/pkgconf/kernel.h:
	Fixed type in configuration option name.

Wed Sep  2 19:01:02 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/mboxt.hxx:
	* include/mboxt.inl:
	* include/mboxt2.hxx:
	* include/mboxt2.inl:
	* include/mempolt2.hxx:
	* include/mempolt2.inl:
	* include/mempoolt.hxx:
	* include/mempoolt.inl:
	* include/sema2.hxx:
	* src/sync/cnt_sem2.cxx:
	* include/flag.hxx:
	* src/sync/flag.cxx:
	* include/kapi.h:
	* src/common/kapi.cxx:
	* tests/kmbox1.c:
	* tests/kmemfix1.c:
	* tests/kmemvar1.c:
	* tests/mbox1.cxx:
	* tests/memfix1.cxx:
	* tests/memvar1.cxx:
	Memory pool (both types) and message boxes (both types) and flags
 	and cnt_sem2-type semaphores now all have absolute timeouts
 	instead of relative ones in the timely wait functions.
	uITRON has changed to add the current time itself.
	Kapi changes are mainly name changes to make it clear that
	timeouts are now absolute.
	The tests (incl. kapi) add in the time themselves now.
	
1998-09-01  Tim Goodwin  <tgoodwin@cygnus.co.uk>

	* include/kapi.h:
	* src/common/kapi.cxx:
	* tests/kclock1.c:
	* tests/kexcept1.c:
	* tests/kmbox1.c:
	* tests/kmemfix1.c:
	* tests/kmemvar1.c:
	* tests/kmutex1.c:
	* tests/ksched1.c:
	* tests/ksem1.c:
	* tests/kthread0.c:
	* tests/kthread1.c:
	* src/test/kcache1.c:
	* src/test/kphilo.c:
	* tests/kphilo.c:
	* tests/lottery.c:
	Changes to cyg_thread_create() interface.

Tue Sep  1 18:49:06 1998  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Moved and renamed CYG_DIAG_USE_DEVICE to infra and to
	CYGDBG_INFRA_DIAG_USE_DEVICE; kernel.h now includes infra.h as
	well as hal.h to ensure all its clients get the info too.
	
	* include/intr.hxx (class Cyg_Interrupt): 
	Add static member interrupts_enabled() to poll the current status;
	just to avoid calling the HAL directly, really.

	* include/diag.h: 
	Now just includes cyg/infra/diag.h, so that kernel-specific
	features can be added later - original diag.h has moved to infra,
	and is that includee.

	* src/PKGconf.mak: 
	Trace folder and its contents elided, now in infra.

	* src/trace/diag.c:
	* src/trace/fancy.cxx:
	* src/trace/null.cxx:
	* src/trace/simple.cxx:
	* src/trace/tcdiag.cxx:
	Deleted; all moved to infra, actually.

1998-09-01  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/dbg-threads-api.h: 
	* src/debug/dbg_gdb.cxx:
	Converted threadref from long long to char[8] as defined by Cygmon
	guys.

	* src/common/thread.cxx:
	Added scheduler lock around manipulations of thread list.

	* include/except.hxx:
	Now use CYG_EXCEPTION_COUNT to size handler arrays.

Mon Aug 31 17:53:12 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/memfixed.hxx, include/mempolt2.hxx, include/mempolt2.inl,
	  include/mempoolt.hxx, include/mempoolt.inl, include/memvar.hxx,
	  include/mvarimpl.hxx, include/mvarimpl.inl, src/mem/memfixed.cxx,
	  src/mem/memvar.cxx:
	
	Add new get_allocation_size() method to return the size of a
	previously allocated block - trivial for fixed block allocator, and
	requiring a bit of poking around for the variable block allocator.

	This is required for the C library realloc() implementation. Strictly
	this only uses the variable block allocator, but the API can only be
	enhanced by also updating the template. As a result, this also meant
	doing it for the fixed block allocator.	

Mon Aug 31 09:51:37 1998  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/stubrom.c (cyg_start): Renamed from main().

Mon Aug 31 09:00:01 1998  Jesper Skov  <jskov@cygnus.co.uk>

	* src/common/thread.cxx: Fixed typo.

1998-08-28  Bart Veer  <bartv@cygnus.co.uk>

	* include/pkgconf/kernel.h, include/bitmap.hxx, include/clock.hxx,
	  include/except.hxx, include/flag.hxx, include/instrmnt.h,
	  include/intr.hxx, include/kapi.h, include/kapidata.h,
	  include/mbox.hxx, include/mboxt.hxx, include/mboxt.inl,
	  include/mboxt2.hxx, include/mboxt2.inl, include/memfixed.hxx,
	  include/mempolt2.hxx, include/mempolt2.inl,
	  include/mempoolt.hxx, include/mempoolt.inl, include/memvar.hxx,
	  include/mlqueue.hxx, include/mutex.hxx, include/mvarimpl.inl,
	  include/sched.hxx, include/sema.hxx, include/sema2.hxx,
	  include/thread.hxx, include/thread.inl,
	  include/pkgconf/kernel.h:
	  src/common/clock.cxx, src/common/except.cxx,
	  src/common/kapi.cxx, src/common/thread.cxx,
	  src/debug/dbg_gdb.cxx, src/debug/generic-stub.c,
	  src/instrmnt/meminst.cxx, src/instrmnt/nullinst.cxx,
	  src/intr/intr.cxx, src/mem/memfixed.cxx, src/mem/memvar.cxx,
	  src/sched/bitmap.cxx, src/sched/lottery.cxx,
	  src/sched/mlqueue.cxx, src/sched/sched.cxx,
	  src/sync/cnt_sem.cxx, src/sync/cnt_sem2.cxx, src/sync/flag.cxx,
	  src/sync/mbox.cxx, src/sync/mutex.cxx, src/test/diag.cxx,
	  src/test/kcache1.c, src/test/main.cxx, src/test/timer.cxx,
	  src/test/tstmbox.cxx:
	  tests/clock0.cxx, tests/clock1.cxx, tests/except1.cxx,
	  tests/flag1.cxx, tests/intr0.cxx, tests/kclock0.c,
	  tests/kclock1.c, tests/kexcept1.c, tests/kintr0.c,
	  tests/kmbox1.c, tests/kmemfix1.c, tests/kmemvar1.c,
	  tests/kmutex0.c, tests/kmutex1.c, tests/ksched1.c,
	  tests/ksem0.c, tests/ksem1.c, tests/kthread0.c,
	  tests/kthread1.c, tests/lottery.c, tests/mbox1.cxx,
	  tests/memfix1.cxx, tests/memvar1.cxx, tests/sync3.cxx,
	  tests/thread2.cxx :
	Provide configuration data and rename configuration options

Fri Aug 28 15:27:31 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/trace/fancy.cxx: 
	* src/trace/simple.cxx: 
	* src/trace/null.cxx: 
	Condition on newly named symbols from the infra package, whence
	these units will be moved soon.
	
Fri Aug 28 09:33:17 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/test/demo.cxx, src/test/kcache1.c, src/test/kphilo.c,
	  src/test/main.cxx, src/test/philo.cxx, src/test/sload.c,
	  src/test/timer.cxx, src/test/tstflag.cxx, src/test/tstmbox.cxx,
	  src/test/tstmpf.cxx, src/test/tstmpool.cxx, src/test/tsttracc.c,
	  src/test/tsttrace.cxx, tests/bin_sem0.cxx, tests/bin_sem1.cxx,
	  tests/bin_sem2.cxx, tests/clock0.cxx, tests/clock1.cxx,
	  tests/cnt_sem0.cxx, tests/cnt_sem1.cxx, tests/except1.cxx,
	  tests/flag0.cxx, tests/flag1.cxx, tests/intr0.cxx, tests/kclock0.c,
	  tests/kclock1.c, tests/kexcept1.c, tests/kill.cxx, tests/kintr0.c,
	  tests/kmbox1.c, tests/kmemfix1.c, tests/kmemvar1.c, tests/kmutex0.c,
 	  tests/kmutex1.c, tests/kphilo.c, tests/ksched1.c, tests/ksem0.c,
 	  tests/ksem1.c, tests/kthread0.c, tests/kthread1.c, tests/lottery.c,
 	  tests/mbox1.cxx, tests/memfix1.cxx, tests/memfix2.cxx,
 	  tests/memvar1.cxx, tests/memvar2.cxx, tests/mutex0.cxx,
	  tests/mutex1.cxx, tests/philo.cxx, tests/release.cxx,
	  tests/sched1.cxx, tests/sync2.cxx, tests/sync3.cxx,
	  tests/thread0.cxx, tests/thread1.cxx, tests/thread2.cxx:
	Change entry points from main() to cyg_start(), and remove return
	codes - while main returned an int, cyg_start() returns void. It has
	no meaning anyway - what could you do with the code?

	* src/test/tsttracc.c, src/test/tsttrace.cxx:
	Also change trace calls (CYG_REPORT_...) to reflect that it is a
	function called cyg_start with no args returning void, rather than
	what it was for main(argc, argv)

Fri Aug 28 09:24:41 1998  Jesper Skov  <jskov@cygnus.co.uk>

	* src/debug/generic-stub.c: Moved strcpy/strlen from hal-stub to
	generic-stub. Cleaned up a bit to avoid compiler warnings.

Thu Aug 27 19:22:51 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* tests/kphilo.c (Philosopher): 
	* tests/philo.cxx (Philosopher): 
	* src/test/philo.cxx (Philosopher): 
	* src/test/kphilo.c (Philosopher): 
	* src/common/kapi.cxx: 
	Change CYG_RELEASE_DEBUG to CYGPKG_INFRA_DEBUG.
	These changes are self-contained, so they can go in right now.
	
Thu Aug 27 15:20:31 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/mvarimpl.inl (free): 
	Remove a couple of warning due to pointer comparison without casts
	in coallesce(sic.) code.

1998-08-26  Nick Garnett  <nickg@cygnus.co.uk>

	* include/kapidata.h:
	Added saved_context to cyg_hardwarethread structure to track
	GDB support in rest of kernel.

1998-08-25  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Added CYGIMP_KERNEL_THREAD_GDB_SUPPORT to configure for GDB
	interactions with the kernel.

	* src/debug/dbg-threads-api.h: 
	* src/debug/dbg_gdb.cxx:
	Added these files to repository to support GDB interactions
	with the kernel. Note that dbg-threads-api.h is a copy of a
	file in devo/libstub. Any changes there must be merged in here
	too.

	* src/PKGconf.mak:
	Added debug/dbg_gdb.cxx to COMPILE list.

	* include/thread.inl: 
	* include/thread.hxx:
	Added support for GDB, specifically for thread-aware debugging.

	* include/intr.hxx:
	* src/intr/intr.cxx:
	Added an extra argument to interrupt_end(): a pointer to
	the saved register state. This is optionally used to provide
	a more interesting saved register state for GDB.

Tue Aug 25 02:36:26 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/generic-stub.h: 
	Add void to empty prototype argument lists to silence compiler
	warnings

Fri Aug 21 18:46:34 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* src/common/clock.cxx (enable): 
	Make the maths work right if we only just set up the clock
	thingy.  Unsigned has a lot to answer for; when the next scheduled
	tick was all correct, the delta was -1, which correctly rounds to
	zero in the division.  But it isn't -1 it's 18446744073709551615
 	which gave a shift of 15 in the the uITRON test programs.

Fri Aug 21 11:40:50 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/mboxt2.inl (put): 
	* include/mempolt2.inl (alloc): 
	Tidy Nick's changes (1998-07-27) for set_timer() semantics a bit,
	make it a bit more efficient and smaller code.
	
Thu Aug 20 17:37:35 BST 1998  Chris Provenzano  <proven@cygnus.com>

	* include/mvarimpl.inl, include/pkgconf/kernel.h:
	Added memory coallecsing to the variable size memory allocator.
	This option is enabled my default.

	* tests/stdlib/malloc2.c: Only print 50 messages, not 500.

1998-08-20  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Moved definition of CYG_KERNEL_USE_INIT_PRIORITY from here
	to hal.h.

	* include/thread.hxx:
	Changed argument to cyg_thread_entry() to CYG_ADDRWORD from
	CYG_ADDRESS.

	* include/ktypes.h:
	Moved constructor priority ordering stuff out to infra/cyg_type.h.

	* include/kapi.h: 
	* src/common/kapi.cxx:
	Added name and priority parameters to cyg_thread_create() and
	swapped stack size and base parameters. These changes are
	currently protected by DAY_OF_CHAOS ifdefs and are therefore
	inactive.

Wed Aug 19 19:06:16 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* tests/bin_sem1.cxx, tests/bin_sem2.cxx, tests/cnt_sem1.cxx,
	  tests/flag1.cxx, tests/mbox1.cxx, tests/memfix2.cxx,
	  tests/memvar2.cxx, tests/sync2.cxx, tests/sync3.cxx,
	  tests/thread2.cxx, tests/release.cxx, tests/kill.cxx: 
	Reorder inclusion of thread.inl to silence warnings

Wed Aug 19 18:48:03 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/kernel.hxx: 
	Reorder inclusion of thread.inl to silence warnings

Wed Aug 19 18:21:31 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/common/kapi.cxx, src/sync/flag.cxx: 
	Reorder inclusion of thread.inl to silence warnings

	* src/sync/bin_sem.cxx, src/sync/cnt_sem.cxx, src/sync/cnt_sem2.cxx,
	  src/sync/mbox.cxx:
	Add inclusion of thread.inl to silence warnings

	* src/common/memset.c:
	Make pointer arithmetic be on char *, not void * to silence warnings

	* include/diag.h, src/trace/diag.c:
	Make diag_init take void parameter, and give diag_printf explicit
	parameters in prototypes to silence warnings

1998-08-19  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	* src/common/thread.cxx:
	Added ifdef for CYGIMP_IDLE_THREAD_YIELD to support single
	priority configurations.

Tue Aug 18 16:56:38 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/thread.hxx, include/thread.inl: 
	To silence compiler warnings, move register_exception inline definition
	from the .hxx to the .inl. Also move attach_stack to before the
	constructor where it is invoked from.

1998-08-18  Nick Garnett  <nickg@cygnus.co.uk>

	* include/pkgconf/kernel.h:
	Moved all HAL specific config options out to a HAL config file.

	* include/kapi.h: 
	* src/common/kapi.cxx:
	Added cyg_scheduler_lock() and cyg_scheduler_unlock() to provide
	user access to the scheduler lock.

Mon Aug 17 21:39:20 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/kapi.h: 
	Insert "void" to empty parameter lists to silence warnings

Fri Aug 14 18:10:20 1998  Hugo Tyson  <hmt@masala.cygnus.co.uk>

	* src/common/thread.cxx (exit): 
	Set the state explicitly to EXITED rather than or'ing
	it in; should be safe cos it's what kill does in the normal case.
	Needed to avoid suspend sort of states persisting after death.
	One character changes are always aesthetically pleasing.

Fri Aug 14 17:28:01 1998  Hugo Tyson  <hmt@cygnus.co.uk>

	* include/pkgconf/kernel.h: 
	Add config options as below:

	* src/common/thread.cxx:
	Add asserts of CYGNUM_KERNEL_MAX_COUNTED_WAKE_COUNT_ASSERT
	and CYGNUM_KERNEL_MAX_SUSPEND_COUNT_ASSERT if they are defined.
	Also lazily tidied format of func hdrs as per code review et al.

1998-08-14  Nick Garnett  <nickg@cygnus.co.uk>

	* include/kapidata.h:
	Added support for thread names and thread housekeeping list.

	* src/common/delete.cxx:
	Added include for cyg_type.h.

	* include/pkgconf/kernel.h:
	Added CYGIMP_THREAD_NAME and CYGIMP_THREAD_LIST options.

	* include/thread.inl: 
	* include/thread.hxx:
	Added support for thread names and thread housekeeping list.

	* src/common/thread.cxx:
	Added support for thread names and thread housekeeping list.
	Fixed ordering bug in Cyg_Thread::delay().

Thu Aug 13 15:33:48 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* include/ktypes.h:
	Remove inlined new and delete as they aren't strictly permitted and
	they prevent a valid new and delete being defined anywhere else!
	
	* src/common/delete.cxx, src/PKGconf.mak: 
	Add delete.cxx to provide default delete operation for when a C
	library isn't present

1998-07-28  Nick Garnett  <nickg@cygnus.co.uk>

	* include/thread.hxx, include/sched.hxx, include/mlqueue.hxx,
	  include/lottery.hxx, include/bitmap.hxx, src/common/thread.cxx,
	  src/sched/sched.cxx, src/sched/mlqueue.cxx, src/sched/lottery.cxx,
	  src/sched/bitmap.cxx:
	Added an alternative constructor to Cyg_Thread which takes
	arguments in new order, and includes a scheduling parameters
	argument. Propagated effects of this through Cyg_SchedThread
	and Cyg_SchedThread_Implementation. This mostly takes the form
	of passing the scheduling parameters through to the constructors.

1998-07-27  Nick Garnett  <nickg@cygnus.co.uk>

	* src/sync/flag.cxx, src/sync/cnt_sem2.cxx, include/mempoolt.inl,
	  include/mempolt2.inl, include/mboxt2.inl, include/mboxt.inl:
	Modified code in API calls that take a timeout to allow for a
	timeout in the past.
	NOTE: The timeouts have for now been left as relative delays, they
	should be converted to absolute timeouts.

	* src/common/thread.cxx:
	Modified code in counted_sleep to allow	for a timeout in the past.
	Added handling of EXIT wake_reason in delay().

1998-07-24  Nick Garnett  <nickg@cygnus.co.uk>

	* include/thread.inl:
	Reordered code in Cyg_Thread::set_timer() to init the timer after
	wake_reason has been assigned.

	* include/clock.inl: 
	Removed Cyg_Alarm::enable().
	
	* src/sync/mutex.cxx (Cyg_Condition_Variable::wait): 
	Modified order of code in timed version of wait to allow for a
	timout in the past.
	
	* src/sync/cnt_sem.cxx (Cyg_Counting_Semaphore::wait):
	Modified order of code in timed version of wait to allow for a
	timout in the past. Also modified timeout to be absolute rather
	than relative.

	* src/common/thread.cxx (Cyg_Thread::wake):
	Added test for whether a thread is actually asleep before waking
	it. Allows us to apply wake() to awake threads without damage.

	* src/common/clock.cxx:
	Added code to Cyg_Counter::add_alarm() to deal with alarms
	that trigger now or in the past.
	Moved Cyg_Alarm::enable() here. Added code to do the right thing
	when reenabling previously disabled interval alarms.

1998-07-23  Nick Garnett  <nickg@cygnus.co.uk>

	* src/debug/stubrom.c: Added header comments.

Thu Mar 26 18:25:36 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/test/philo.cxx:
	Rename CYG_DEBUG ifdef to CYG_RELEASE_DEBUG

Wed Mar 25 23:23:39 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* configure.in: Fix so non_arch.h is updated even if
	config.cache does exists.

	* include/kapi.h, include/kapidata.h, include/kernel.hxx
	* include/mboxt.inl, include/sched.hxx:
	#include <eccconf/kernel.h> instead of include <eccconf/kernel.h>

	* include/eccconf/kernel.h: Added. This was old devo/config.h

	* src/Makefile.am : Set CYG_CONFIGURATION to "<eccconf/kernel.h>"

	* src/test/Makefile.am : Build .gdbinit from gdbinit.in
	and tree from tree.in

Wed Mar 25 18:24:48 1998  Jonathan Larmour  <jlarmour@cygnus.co.uk>

	* src/Makefile.am, src/common/memcpy.c, src/common/memset.c:
	  Move memcpy and memset functions from C library into kernel to
	  satisfy the requirements of gcc - namely it must be available at
	  at all time. Changed memcpy and memset to sit more cleanly in the
	  kernel, and lose all dependencies on the C library
	* src/Makefile.in: regenerated

Fri Mar 13 18:36:42 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* configure.in : Add rule to get correct objcopy for target
	* src/test/Makefile.am : Add rule to build philo.srec

Fri Mar 13 11:47:23 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* configure.in, non_arch.h.in, non_arch.sh
	Add support for the mn103000

Thu Mar 12 11:38:28 GMT 1998  David Moore       <dsm@cygnus.co.uk>

	* src/Makefile.am:
	Removed flag to leave comments in generated linker script.
       
Thu Mar 12 10:55:20 GMT 1998  David Moore       <dsm@cygnus.co.uk>

	* configure.in:
	Fixed setting of platform variable

Wed Mar 11 16:54:28 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* src/test/Makefile.am, tests/Makefile.am:
	Make sure CXXFLAGS from configure are also used

Wed Mar 11 16:16:57 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* configure.in, non_arch.h.in. non_arch.sh:
	Added build support for mips 
	* tests/Makefile.am, src/test/Makefile.am
	Link with -nostdlib -lgcc

Wed Mar 11 14:43:36 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* Makefile.am, configure.in, tests/Makefile.am
	support building tests in the tests directory

Wed Mar 11 13:18:17 GMT 1998  Chris Provenzano  <proven@cygnus.com>

	* acinclude.m4, stamp-h.in, non_arch.h.in, src/Makefile.am:
	Added to support new kernel configure/make process

	* Makefile.am: Modified to support new kernel configure/make 
	process.

	* src/acinclude.m4, src/aclocal.m4, src/configure, src/configure.in
	Deleted to support new kernel configure/make process

	* Makefile.in, configure, aclocal.m4, src/Makefile.in, 
	src/configure: regenerated

	* non_arch.sh: New shellscript to change platform/startup/debug
	options after a configure is done.

	* src/devo/config.h: include non_arch.h, for platform/startup/debug
	options. This is generated at configure and modified by non_arch.sh

//===========================================================================
//####COPYRIGHTBEGIN####
//
// -------------------------------------------
// The contents of this file are subject to the Cygnus eCos Public License
// Version 1.0 (the "License"); you may not use this file except in
// compliance with the License.  You may obtain a copy of the License at
// http://sourceware.cygnus.com/ecos
// 
// Software distributed under the License is distributed on an "AS IS"
// basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.  See the
// License for the specific language governing rights and limitations under
// the License.
// 
// The Original Code is eCos - Embedded Cygnus Operating System, released
// September 30, 1998.
// 
// The Initial Developer of the Original Code is Cygnus.  Portions created
// by Cygnus are Copyright (C) 1998,1999 Cygnus Solutions.  All Rights Reserved.
// -------------------------------------------
//
//####COPYRIGHTEND####
//===========================================================================
